@model Exchange.DTO.Account
@{
    ViewBag.Title = "Two Factor Authentication";
}
<div class="row">
    <div class="col-md-12 widget-holder">
        <div class="widget-bg">
            <div class="widget-body clearfix">
                <div class="panel panel-primary">
                    <h5 class="panel-heading"><i class="fa fa-exclamation-triangle"></i> TWO FACTOR AUTHENTICATION</h5>
                    <div class="panel-body row">
                        <p>
                            Two-factor authentication (2fa) greatly increases security by requiring both your password and another form of authentication. Exchange implements 2fa utilizing Google Authenticator. 
                            <br />To enable this feature simply download <strong>Google Authenticator</strong> app on your mobile device and scan the QRCode.
                            <br />
                            Once you have linked the Authenticator with Exchange, enter the 6 digit code provided.
                        </p>
                        @if (Model.TwoFactorEnabled == true)
                        {
                            <h3>2FA is already enabled into your account</h3>
                        }
                        else
                        {
                            <div class="col-md-8">
                                <img src="@Url.Content(ViewBag.barCodeUrl)" />
                                <h6>Scan QR code using Google Authenticator App</h6>
                            </div>
                            <div class="col-md-4">
                                <div style="width:100%;height:250px"></div>
                                @using (Html.BeginForm("Verify2FACode", "Dashboard", FormMethod.Post))
                                {
                                    <div class="form-group ">
                                        <label>Enter 6 digits code</label>
                                        <input type="number" name="code" class="form-control" />
                                    </div>
                                                <input type="submit" class="btn btn-success" value="Enable 2FA" />
                                }
                                <div>

                                </div>
                            </div>
                        }


                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

